<%# 1. ユーザー名表示 %>
<div class="user-info" style="margin-bottom: 20px;">
  <h2 style="font-size: 1.2rem; border-bottom: 1px solid #ddd; padding-bottom: 5px;">
    <%= current_user.name %> さんの手帳
  </h2>
</div>

<%# 2. CSS読み込み %>
<%= stylesheet_link_tag "tasks_index" %>

<%# 3. カレンダー全体を囲むコンテナ %>
<div class="calendar-container">
  <%= month_calendar(events: @tasks, attribute: :start_time) do |date, tasks| %>
    
    <div class="day-header" style="display: flex; justify-content: space-between;">
      <%# spanにday-numberクラスを追加して、土日の色設定が効くようにする HolidayJp.holiday?(date) で祝日判定。祝日なら 'holiday' クラスをつける %>
      <span class="day-number <%= 'sun' if date.sunday? %> <%= 'sat' if date.saturday? %> <%= 'holiday' if HolidayJp.holiday?(date) %>">
        <%= link_to date.day, new_task_path(deadline: date), style: "text-decoration: none; color: inherit;" %>
      </span>
      <%# オプション：祝日名を表示する %>
      <% if holiday = HolidayJp.between(date, date).first %>
       <div class="holiday-name" style="font-size: 0.6rem; color: #d32f2f; margin-top: 2px;">
        <%= holiday.name %>
       </div>
      <% end %>
    </div>

    <div class="day-body">
      <% tasks.each do |task| %>
       <div class="task-entry">
        <%# 予定（schedule）かつ開始時間がある場合、時間（HH:mm）を表示 %>
        <% if task.schedule? && task.start_at.present? %>
         <span style="font-size: 0.8em; color: #666;">
          <%= task.start_at.strftime("%H:%M") %>
         </span>
        <% end %>
      
        <%= link_to task.title, task_path(task), class: "task-link" %>
       </div>
      <% end %>
    </div>
    
  <% end %>
</div>